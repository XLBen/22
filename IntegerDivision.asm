@R1
D=M
@NOT_ZERO_CHECK
D;JNE
@DIVIDE_BY_ZERO_ERR
0;JMP
(NOT_ZERO_CHECK)

@R0
D=M
@SIGN_FLAG_R0
M=0
@SKIP_R0_NEGATIVE_CHECK
D;JGE
@SIGN_FLAG_R0
M=1
(SKIP_R0_NEGATIVE_CHECK)

@R0
D=M
@ABS_VAL_R0
M=D
@SKIP_R0_ABSOLUTIZE
D;JGE
@ABS_VAL_R0
M=-D
(SKIP_R0_ABSOLUTIZE)

@R1
D=M
@SIGN_FLAG_R1
M=0
@SKIP_R1_NEGATIVE_CHECK
D;JGE
@SIGN_FLAG_R1
M=1
(SKIP_R1_NEGATIVE_CHECK)

@R1
D=M
@ABS_VAL_R1
M=D
@SKIP_R1_ABSOLUTIZE
D;JGE
@ABS_VAL_R1
M=-D
(SKIP_R1_ABSOLUTIZE)

@ABS_VAL_R0
D=M
@32768
D=D-A
@OVERFLOW_CHECK_POINT
D;JEQ
@DIVISION_START_POINT
0;JMP

(OVERFLOW_CHECK_POINT)
@ABS_VAL_R1
D=M
@ONE_CONSTANT
D=D-A
@OVERFLOW_ERROR_HANDLER
D;JEQ

(DIVISION_START_POINT)
@ABS_VAL_R0
D=M
@REMAINDER_VAR
M=D
@QUOTIENT_VAR
M=0

(DIVISION_LOOP_CYCLE)
@ABS_VAL_R1
D=M
@REMAINDER_TEMP
M=D
@REMAINDER_VAR
D=M-D
@DIVISION_END_LOOP
D;JLT
@ABS_VAL_R1
D=M
@REMAINDER_VAR
M=M-D
@QUOTIENT_VAR
M=M+1
@DIVISION_LOOP_CYCLE
0;JMP

(DIVISION_END_LOOP)
@SIGN_FLAG_R0
D=M
@SIGN_FLAG_R1
D=D-M
@APPLY_NEGATIVE_TO_QUOTIENT
D;JNE
@SET_REMAINDER_SIGN_FLAG
0;JMP

(APPLY_NEGATIVE_TO_QUOTIENT)
@QUOTIENT_VAR
M=-M

(SET_REMAINDER_SIGN_FLAG)
@SIGN_FLAG_R0
D=M
@SKIP_REMAINDER_NEGATION
D;JEQ
@REMAINDER_VAR
M=-M

(SKIP_REMAINDER_NEGATION)
@ERROR_CODE
M=0
@PROGRAM_TERMINATE
0;JMP

(DIVIDE_BY_ZERO_ERR)
@QUOTIENT_VAR
M=0
@REMAINDER_VAR
M=0
@ERROR_CODE
M=1
@PROGRAM_TERMINATE
0;JMP

(OVERFLOW_ERROR_HANDLER)
@QUOTIENT_VAR
M=0
@REMAINDER_VAR
M=0
@ERROR_CODE
M=1
@PROGRAM_TERMINATE
0;JMP

(PROGRAM_TERMINATE)
@PROGRAM_TERMINATE
0;JMP